{% extends "base.html" %}

{% block title %}Analytics - AI Study Tutor{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ðŸ“Š Analytics & Insights</h1>
    <p>Explore your study material analysis</p>
</div>

<div class="analytics-section">
    <!-- Statistics Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <h3>Total Chunks</h3>
            <p class="stat-value">{{ analytics.chunk_stats.count }}</p>
        </div>
        <div class="stat-card">
            <h3>Average Length</h3>
            <p class="stat-value">{{ "%.0f"|format(analytics.chunk_stats.mean_length) }}</p>
            <p class="stat-label">characters</p>
        </div>
        <div class="stat-card">
            <h3>Min Length</h3>
            <p class="stat-value">{{ analytics.chunk_stats.min_length }}</p>
        </div>
        <div class="stat-card">
            <h3>Max Length</h3>
            <p class="stat-value">{{ analytics.chunk_stats.max_length }}</p>
        </div>
    </div>
    
    <!-- Visualizations -->
    <div class="chart-container">
        <h2>Chunk Length Distribution</h2>
        <img src="{{ analytics.charts.length_dist }}" alt="Length Distribution" class="chart-img">
    </div>
    
    <div class="chart-container">
        <h2>Top Keywords</h2>
        <img src="{{ analytics.charts.keywords }}" alt="Top Keywords" class="chart-img">
    </div>
    
    <div class="two-column-charts">
        <div class="chart-container">
            <h2>Word Cloud</h2>
            <img src="{{ analytics.charts.wordcloud }}" alt="Word Cloud" class="chart-img">
        </div>
        
        <div class="chart-container">
            <h2>PCA Visualization</h2>
            <img src="{{ analytics.charts.pca }}" alt="PCA" class="chart-img">
        </div>
    </div>
    
    <div class="chart-container">
        <h2>Document Clustering</h2>
        <img src="{{ analytics.charts.clustering }}" alt="Clustering" class="chart-img">
    </div>
    
    <!-- Cluster Distribution -->
    <div class="cluster-info">
        <h2>Cluster Distribution</h2>
        <div class="cluster-grid">
            {% for cluster, count in analytics.cluster_distribution.items() %}
            <div class="cluster-card">
                <h4>{{ cluster }}</h4>
                <p>{{ count }} chunks</p>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- Top Keywords Table -->
    <div class="keywords-table">
        <h2>Keyword Frequencies</h2>
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Term</th>
                    <th>Count</th>
                </tr>
            </thead>
            <tbody>
                {% for keyword in analytics.top_keywords[:20] %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ keyword.term }}</td>
                    <td>{{ keyword.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
